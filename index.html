<!DOCTYPE html>
<html lang="ru">
<meta charset="UTF-8">
<title>Кенгурёнок</title>

<head>
  <link rel="stylesheet" href="styles.css">
</head>

<div class="content">
  <canvas id="c" width="500" height="500" style="border:1px solid #000" class="canvas_cnt"></canvas>
  <br>
  <textarea id="code" rows="8" cols="40" class="command_cnt">начало

конец</textarea>

  <div class="buttons"></div>
  <button onclick="run()" role="button" class="golden-button">
    <span class="golden-text">Запустить</span>
  </button>
  <!--
  <button onclick="load()" role="button" class="golden-button">
    <span class="golden-text">Загрузить</span>
  </button>
  -->
</div>
</div>

<script>
  const ctx = c.getContext('2d');
  let x = 250, y = 250, angle = 0; // начальная позиция и угол
  const stepSize = 20;

  function drawLine(steps) {
    const nx = x + Math.cos(angle * Math.PI / 180) * steps * stepSize;
    const ny = y + Math.sin(angle * Math.PI / 180) * steps * stepSize;
    ctx.beginPath();
    ctx.moveTo(x, y);
    ctx.lineTo(nx, ny);
    ctx.stroke();
    x = nx; y = ny;
  }

  function jump(steps) {
    const nx = x + Math.cos(angle * Math.PI / 180) * steps * stepSize;
    const ny = y + Math.sin(angle * Math.PI / 180) * steps * stepSize;
    x = nx; y = ny; // просто перемещаемся
  }

  function run() {
    ctx.clearRect(0, 0, c.width, c.height);
    x = 10; y = 10; angle = 0;
    const lines = code.value.trim().split(/\n/);
    for (let line of lines) {
      line = line.trim().toLowerCase();
      if (line.startsWith('шаг')) {
        let n = parseInt(line.split(' ')[1] || '1', 10);
        drawLine(n);
      }
      else if (line.startsWith('прыжок')) {
        let n = parseInt(line.split(' ')[1] || '1', 10);
        jump(n);
      }
      else if (line === 'поворот вправо') angle += 90;
      else if (line === 'поворот влево') angle -= 90;
      // начало и конец просто игнорируем
    }
  }
</script>

</html>